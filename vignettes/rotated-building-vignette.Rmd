---
title: "bpip: Rotated building"
author: "MPCA - Risk evaluation and air modeling, EAO division"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    toc: true
    keep_md: true
vignette: >
  %\VignetteIndexEntry{bpip: Rotated building}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{}
---

## Running BPIP for a rotated building

This example creates downwash inputs for a 10x10x10 building that is rotated 45 degrees. The structure will be positioned 20 meters to the West of an air emissions source.

## Install BPIP to the working directory
```{r eval = T}
library(installEPA)
install_epa("bpip", "EPA")
```

## Create new bpip table
```{r }
library(bpip)
builds <- bld_tbl()

library(knitr)
kable(builds)
```

## Adjust building parameters
```{r }
builds$bld_rotation      <- 45

builds$length_x          <- 10

builds$angle_from_source <- 270 

kable(builds)
```

## Plot building
```{r }
plot_bpip(builds)
```


## Add a building
```{r }
builds <- rbind(builds, builds)

builds$building[2]          <- "Bld_2"

builds$angle_from_source[2] <- 90

builds$bld_rotation[2]      <- 60

builds$height[2]            <- 15

kable(builds)
```


## Plot buildings
```{r }
plot_bpip(builds)
```

## Create bpip input file
```{r }
write_bpip(builds, "rotated_building.inp")
```

## Run bpip
```{r }
run_bpip("rotated_building.inp", "rotated_results", exe_folder = "EPA/bpip")
```

## Read results
```{r }
results <- read_bpip_out(file = "rotated_results.out", as_text = FALSE)

kable(results)
```


